<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
	<title></title>
	<meta name="generator" content="LibreOffice 6.1.5.2 (Linux)"/>
	<meta name="created" content="2015-12-12T09:37:03.193001702"/>
	<meta name="changedby" content="Mark Grant"/>
	<meta name="changed" content="2020-10-27T15:18:08.620215476"/>
	<style type="text/css">
		@page { size: 21cm 29.7cm; margin: 2cm }
		p { margin-bottom: 0.25cm; background: transparent; line-height: 120%; background: transparent }
		h1 { margin-bottom: 0.21cm; background: transparent; background: transparent; page-break-after: avoid }
		h1.western { font-family: "Liberation Sans", sans-serif; font-size: 18pt; font-weight: bold }
		h1.cjk { font-family: "Droid Sans Fallback"; font-size: 18pt; font-weight: bold }
		h1.ctl { font-family: "FreeSans"; font-size: 18pt; font-weight: bold }
		a:link { color: #000080; so-language: zxx; text-decoration: underline }
		a:visited { color: #800000; so-language: zxx; text-decoration: underline }
	</style>
</head>
<body lang="en-GB" link="#000080" vlink="#800000" dir="ltr"><h1 class="western" align="center">
Fedora Repo CRUD</h1>
<p align="left"><br/>
<br/>

</p>
<ol>
	<li><p align="left">Removing a repo is just a question of deleting
	the .repo file.</p>
	<ol type="a">
		<li><p align="left">sudo rm /etc/yum.repos.d/repo-file.repo</p>
	</ol>
	<li><p align="left">Adding a repo.</p>
	<ol type="a">
		<li><p align="left">To add a repo by creating the .repo file
		yourself in /etc/yum.repos.d</p>
		<ul>
			<li><p align="left"><a href="http://hermes/pkghost/rpmpkg/hermes-fedora-beta.repo">example.repo</a></p>
			<li><p align="left">sudo dnf config-manager --add-repo
			/etc/yum.repos.d/example.repo</p>
		</ul>
		<li><p align="left">To add a locally hosted repo</p>
		<ul>
			<li><p align="left">Logon to the rpm repository hosting machine</p>
			<ul>
				<li><p align="left">ssh mgrant@hermes</p>
			</ul>
			<li><p align="left">Make sure the directory structure exists</p>
			<ul>
				<li><p align="left">sudo mkdir -p
				/srv/repos/package/rpm/fedora/30/beta/no-arch</p>
				<li><p align="left">sudo mkdir -p
				/srv/repos/package/rpm/fedora/30/beta/x86_64</p>
			</ul>
			<li><p align="left">Build the repository</p>
			<ul>
				<li><p align="left">sudo createrepo -v
				/srv/repos/package/rpm/fedora/30/beta</p>
			</ul>
			<li><p align="left">Sign the repository</p>
			<ul>
				<li><p align="left">sudo gpg --armor --verbose --detach-sign
				--default-key &quot;mgrant@hermes.mgent.home&quot;
				/srv/repos/package/rpm/fedora/30/beta/repodata/repomd.xml</p>
				<li><p align="left">sudo gpg --armor --export
				&quot;mgrant@hermes.mgent.home&quot; &gt; repomd.xml.key</p>
				<li><p align="left">sudo cp -v repomd.xml.key
				/srv/repos/package/rpm/fedora/30/beta/repodata</p>
				<li><p align="left">rm repomd.xml.key</p>
			</ul>
			<li><p align="left">Create a repo file in
			/srv/repos/package/rpm/fedora</p>
			<ul>
				<li><p align="left"><a href="http://hermes/pkghost/rpmpkg/hermes-fedora-beta.repo">example.repo</a></p>
			</ul>
			<li><p align="left">sudo dnf config-manager --add-repo
			<a href="http://hermes.mgent.home/rpmrepos/fedora/hermes-beta.repo">http://hermes.mgent.home/rpmrepos/fedora/hermes-beta.repo</a></p>
		</ul>
		<li><p align="left">To add an externally hosted repo</p>
		<ul>
			<li><p align="left">sudo dnf config-manager --add-repo
			repository_url</p>
		</ul>
		<li><p align="left">Then enable it</p>
		<ul>
			<li><p align="left">sudo dnf config-manager --set-enabled
			hermes-beta</p>
		</ul>
	</ol>
	<li><p align="left">Then refresh</p>
	<ol type="a">
		<li><p align="left">sudo dnf upgrade --refresh</p>
	</ol>
	<li><p align="left">If using Dependency On Server At Boot</p>
	<ol type="a">
		<li><p align="left">Copy the repo files to /etc/dosab</p>
	</ol>
</ol>
</body>
</html>